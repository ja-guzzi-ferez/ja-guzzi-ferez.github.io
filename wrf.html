<!DOCTYPE html>
<html lang="es" class="light">
<head>
  <meta charset="UTF-8">
  <title>Mapa Interactivo WRF - Multivariable</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="style/wrf.css">
  <script>
    // Cargar tema ANTES de renderizar (prevenir flash)
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark') {
      document.documentElement.classList.remove('light');
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.add('light');
      document.documentElement.classList.remove('dark');
    }
  </script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" defer></script>
  <script src="https://unpkg.com/leaflet-rotatedmarker@0.2.0/leaflet.rotatedMarker.js" defer></script>
  <script src="js/wrf.js" defer></script>
</head>
<body>

<header class="h-16 border-b border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 flex items-center justify-center px-6 fixed left-0 right-0 z-50">
  <div class="flex items-center gap-4">
    <div class="bg-primary p-1-5 rounded-lg">
      <span class="material-icons text-white text-2xl">thunderstorm</span>
    </div>
    <h1 class="text-xl font-bold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-primary to-blue-600">
      HIDROCLIMET <span class="font-light text-slate-400">Visualizer</span>
    </h1>
  </div>
  <div class="flex items-center gap-4" style="position: absolute; right: 1.5rem;">
    <button id="theme-toggle" class="p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-500 dark:text-slate-400" onclick="document.documentElement.classList.toggle('dark'); document.documentElement.classList.toggle('light'); localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');">
      <span id="icon-dark" class="material-icons">dark_mode</span>
      <span id="icon-light" class="material-icons" style="display:none;">light_mode</span>
    </button>
  </div>
</header>

<!-- Sistema de Pestañas -->
<div class="tabs-wrapper">
  <div class="tabs-header">
    <button class="tab-button active" data-tab="tab-frentes">
      <span class="material-icons">wb_sunny</span>
      <span>Condiciones actuales</span>
    </button>
    <button class="tab-button" data-tab="tab-mapa">
      <span class="material-icons">layers</span>
      <span>Modelos Meteorológicos</span>
    </button>
    <button class="tab-button" data-tab="tab-ciclones">
      <span class="material-icons">cyclone</span>
      <span>Ciclones Tropicales</span>
    </button>
    <button class="tab-button" data-tab="tab-oceanografia">
      <span class="material-icons">waves</span>
      <span>Oceanografía</span>
    </button>
    <button class="tab-button" data-tab="tab-estacionales">
      <span class="material-icons">calendar_month</span>
      <span>Modelos Estacionales</span>
    </button>
  </div>

  <div class="tabs-content">
    <!-- Pestaña 1: Condiciones actuales (frentes + satélite opcional) -->
    <div id="tab-frentes" class="tab-panel active">
      <div id="layout-frentes">
        
        <!-- Mapa principal -->
        <div id="map-frentes"></div>

        <!-- Leyenda de satélite (se muestra solo si banda activa) -->
        <div id="legend-wrapper-satelite" style="display:none;">
          <img id="legend-img-satelite" src="images/B13_vertical.png" alt="Leyenda de temperatura">
        </div>

        <!-- Controles a la derecha -->
        <div id="frentes-controls">
          <span class="section-label">Capas</span>
          <label class="checkbox-item">
            <div class="checkbox-label-wrapper">
              <span class="material-icons">layers</span>
              <span>Frentes sinópticos</span>
            </div>
            <input type="checkbox" id="toggle-frentes" checked>
          </label>

          <span class="section-label">Área de Enfoque</span>
          <div class="select-wrapper">
            <div class="select-header">
              <span>Selecciona el estado</span>
              <span class="material-icons">public</span>
            </div>
            <select id="buscador-satelite">
            <option value="">-- Selecciona un estado --</option>
            <option value="republica_mexicana">República Mexicana</option>
            <option value="aguascalientes">Aguascalientes</option>
            <option value="baja_california">Baja California</option>
            <option value="baja_california_sur">Baja California Sur</option>
            <option value="campeche">Campeche</option>
            <option value="chiapas">Chiapas</option>
            <option value="chihuahua">Chihuahua</option>
            <option value="ciudad_de_mexico">Ciudad de México</option>
            <option value="coahuila">Coahuila</option>
            <option value="colima">Colima</option>
            <option value="durango">Durango</option>
            <option value="estado_de_mexico">Estado de México</option>
            <option value="guanajuato">Guanajuato</option>
            <option value="guerrero">Guerrero</option>
            <option value="hidalgo">Hidalgo</option>
            <option value="jalisco">Jalisco</option>
            <option value="michoacan">Michoacán</option>
            <option value="morelos">Morelos</option>
            <option value="nayarit">Nayarit</option>
            <option value="nuevo_leon">Nuevo León</option>
            <option value="oaxaca">Oaxaca</option>
            <option value="puebla">Puebla</option>
            <option value="queretaro">Querétaro</option>
            <option value="quintana_roo">Quintana Roo</option>
            <option value="san_luis_potosi">San Luis Potosí</option>
            <option value="sinaloa">Sinaloa</option>
            <option value="sonora">Sonora</option>
            <option value="tabasco">Tabasco</option>
            <option value="tamaulipas">Tamaulipas</option>
            <option value="tlaxcala">Tlaxcala</option>
            <option value="veracruz">Veracruz</option>
            <option value="yucatan">Yucatán</option>
            <option value="zacatecas">Zacatecas</option>
          </select>
          </div>

          <span class="section-label">Banda de Satélite</span>
          <div class="select-wrapper">
            <div class="select-header">
              <span>Selecciona la banda</span>
              <span class="material-icons">satellite_alt</span>
            </div>
            <select id="banda-satelite">
            <option value="inactivo" selected>Inactivo</option>
            <option value="B13">Banda 13 (IR)</option>
          </select>
          </div>
        </div>

        <!-- Slider abajo (solo visible si banda activa) -->
        <div id="bottom-controls-satelite" style="display:none;">
          <div id="time-display-satelite">Satélite inactivo</div>

          <div id="slider-container-satelite">
            <input type="range" id="slider-satelite" min="0" max="0" value="0" step="1">
            <div id="time-range-satelite">Frame 0 de 0</div>

            <div>
              <button id="prevBtn-satelite"><span class="material-icons">skip_previous</span></button>
              <button id="playBtn-satelite"><span class="material-icons">play_arrow</span></button>
              <button id="pauseBtn-satelite" style="display:none;"><span class="material-icons">pause</span></button>
              <button id="nextBtn-satelite"><span class="material-icons">skip_next</span></button>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Pestaña 2: Mapa (contenido actual) -->
    <div id="tab-mapa" class="tab-panel">
      <div id="layout">
        
        <!-- Mapa -->
        <div id="map"></div>

        <!-- Leyenda -->
        <div id="legend-wrapper">
          <img id="legend-img" src="" alt="Leyenda de colores">
        </div>

        <!-- Controles a la derecha -->
        <div id="variable-selector">
    <span class="section-label">Configuración del Modelo</span>
    <div class="select-wrapper">
      <div class="select-header">
        <span>Modelo Meteorológico</span>
        <span class="material-icons">public</span>
      </div>
      <select id="modelos">
      <option value="WRF" selected="selected">WRF</option>
      <option value="GFS">GFS</option>
      <option value="ECMWF">ECMWF</option>
      <option value="ICON">ICON</option>
    </select>
    </div>
    
    <span class="section-label">Área de Enfoque</span>
    <div class="select-wrapper">
      <div class="select-header">
        <span>Selecciona el estado</span>
        <span class="material-icons">location_on</span>
      </div>
      <select id="buscador">
      <option value="">-- Selecciona un estado --</option>
      <option value="republica_mexicana">República Mexicana</option>
      <option value="aguascalientes">Aguascalientes</option>
      <option value="baja_california">Baja California</option>
      <option value="baja_california_sur">Baja California Sur</option>
      <option value="campeche">Campeche</option>
      <option value="chiapas">Chiapas</option>
      <option value="chihuahua">Chihuahua</option>
      <option value="ciudad_de_mexico">Ciudad de México</option>
      <option value="coahuila">Coahuila</option>
      <option value="colima">Colima</option>
      <option value="durango">Durango</option>
      <option value="estado_de_mexico">Estado de México</option>
      <option value="guanajuato">Guanajuato</option>
      <option value="guerrero">Guerrero</option>
      <option value="hidalgo">Hidalgo</option>
      <option value="jalisco">Jalisco</option>
      <option value="michoacan">Michoacán</option>
      <option value="morelos">Morelos</option>
      <option value="nayarit">Nayarit</option>
      <option value="nuevo_leon">Nuevo León</option>
      <option value="oaxaca">Oaxaca</option>
      <option value="puebla">Puebla</option>
      <option value="queretaro">Querétaro</option>
      <option value="quintana_roo">Quintana Roo</option>
      <option value="san_luis_potosi">San Luis Potosí</option>
      <option value="sinaloa">Sinaloa</option>
      <option value="sonora">Sonora</option>
      <option value="tabasco">Tabasco</option>
      <option value="tamaulipas">Tamaulipas</option>
      <option value="tlaxcala">Tlaxcala</option>
      <option value="veracruz">Veracruz</option>
      <option value="yucatan">Yucatán</option>
      <option value="zacatecas">Zacatecas</option>
    </select>
    </div>

    <div class="select-wrapper">
      <div class="select-header">
        <span>Variable Visual</span>
        <span class="material-icons">thermostat</span>
      </div>
      <select id="variable-select"></select>
    </div>
    
    <div class="select-wrapper">
      <div class="select-header">
        <span>Fecha y hora</span>
        <span class="material-icons">schedule</span>
      </div>
      <select id="extra-filters"></select>
    </div>

    <span class="section-label">Capas Adicionales</span>
    <label class="checkbox-item">
      <div class="checkbox-label-wrapper">
        <span class="material-icons">air</span>
        <span>Vectores de Viento</span>
      </div>
      <input type="checkbox" id="toggle-wind-checkbox">
    </label>
    <button id="toggle-wind" style="display:none;">Ocultar Vectores</button>
  </div>

  <!-- Slider abajo del mapa -->
  <div id="bottom-controls">
    <div id="time-display">Cargando datos...</div>

    <div id="slider-container">
      <input type="range" id="slider" min="0" max="0" value="0" step="1">
      <div id="time-range">Tiempo 0 de 0</div>

      <div>
        <button id="prevBtn"><span class="material-icons">skip_previous</span></button>
        <button id="playBtn"><span class="material-icons">play_arrow</span></button>
        <button id="pauseBtn" style="display:none;"><span class="material-icons">pause</span></button>
        <button id="nextBtn"><span class="material-icons">skip_next</span></button>
      </div>
    </div>
  </div>

      </div>
    </div>

    <!-- Pestaña 3: Ciclones tropicales -->
    <div id="tab-ciclones" class="tab-panel">
      <div id="layout-ciclones">
        
        <!-- Mapa de Ciclones -->
        <div id="map-ciclones"></div>

        <!-- Leyenda Ciclones -->
        <div id="legend-wrapper-ciclones">
          <img id="legend-img-ciclones" src="images/CICLONES_horizontal.png" alt="Leyenda de ciclones">
        </div>

        <!-- Filtros a la derecha -->
        <div id="variable-selector-ciclones">
          <span class="section-label">Cuencas</span>
          <div id="checkboxes-cuencas"></div>

          <span class="section-label">Años Disponibles</span>
          <div id="checkboxes-anios"></div>

          <span class="section-label">Ciclones</span>
          <div id="checkboxes-ciclones"></div>
        </div>

      </div>
    </div>

    <!-- Pestaña 4: Oceanografía -->
    <div id="tab-oceanografia" class="tab-panel">
      <div id="layout-oceanografia">
        
        <!-- Mapa principal -->
        <div id="map-oceanografia"></div>

        <!-- Leyenda (se muestra según variable) -->
        <div id="legend-wrapper-oceanografia" style="display:none;">
          <img id="legend-img-oceanografia" src="" alt="Leyenda oceanografía">
        </div>

        <!-- Controles a la derecha -->
        <div id="variable-selector-oceanografia">
          <span class="section-label">Área de Enfoque</span>
          <div class="select-wrapper">
            <div class="select-header">
              <span>Selecciona el estado</span>
              <span class="material-icons">public</span>
            </div>
            <select id="buscador-oceanografia">
              <option value="">-- Selecciona un estado --</option>
              <option value="republica_mexicana">República Mexicana</option>
              <option value="aguascalientes">Aguascalientes</option>
              <option value="baja_california">Baja California</option>
              <option value="baja_california_sur">Baja California Sur</option>
              <option value="campeche">Campeche</option>
              <option value="chiapas">Chiapas</option>
              <option value="chihuahua">Chihuahua</option>
              <option value="ciudad_de_mexico">Ciudad de México</option>
              <option value="coahuila">Coahuila</option>
              <option value="colima">Colima</option>
              <option value="durango">Durango</option>
              <option value="estado_de_mexico">Estado de México</option>
              <option value="guanajuato">Guanajuato</option>
              <option value="guerrero">Guerrero</option>
              <option value="hidalgo">Hidalgo</option>
              <option value="jalisco">Jalisco</option>
              <option value="michoacan">Michoacán</option>
              <option value="morelos">Morelos</option>
              <option value="nayarit">Nayarit</option>
              <option value="nuevo_leon">Nuevo León</option>
              <option value="oaxaca">Oaxaca</option>
              <option value="puebla">Puebla</option>
              <option value="queretaro">Querétaro</option>
              <option value="quintana_roo">Quintana Roo</option>
              <option value="san_luis_potosi">San Luis Potosí</option>
              <option value="sinaloa">Sinaloa</option>
              <option value="sonora">Sonora</option>
              <option value="tabasco">Tabasco</option>
              <option value="tamaulipas">Tamaulipas</option>
              <option value="tlaxcala">Tlaxcala</option>
              <option value="veracruz">Veracruz</option>
              <option value="yucatan">Yucatán</option>
              <option value="zacatecas">Zacatecas</option>
            </select>
          </div>

          <div class="select-wrapper">
            <div class="select-header">
              <span>Variable Oceanográfica</span>
              <span class="material-icons">waves</span>
            </div>
            <select id="variable-oceanografia">
              <option value="SST">Temperatura Superficial del Mar (SST)</option>
              <option value="ANOM_SST">Anomalía de TSM (ANOM_SST)</option>
              <option value="OLEAJE">Altura de Oleaje (OLEAJE)</option>
            </select>
          </div>

          <div class="select-wrapper">
            <div class="select-header">
              <span>Fecha y hora</span>
              <span class="material-icons">schedule</span>
            </div>
            <select id="fecha-oceanografia"></select>
          </div>

          <span class="section-label">Capas Adicionales</span>
          <label class="checkbox-item">
            <div class="checkbox-label-wrapper">
              <span class="material-icons">navigation</span>
              <span>Dirección de Oleaje</span>
            </div>
            <input type="checkbox" id="toggle-oleaje-checkbox">
          </label>
          <button id="toggle-oleaje-dir" style="display:none;" disabled>Mostrar Direcciones</button>
        </div>

        <!-- Slider abajo -->
        <div id="bottom-controls-oceanografia" style="display:none;">
          <div id="time-display-oceanografia">Cargando datos...</div>

          <div id="slider-container-oceanografia">
            <input type="range" id="slider-oceanografia" min="0" max="0" value="0" step="1">
            <div id="time-range-oceanografia">Frame 0 de 0</div>

            <div>
              <button id="prevBtn-oceanografia"><span class="material-icons">skip_previous</span></button>
              <button id="playBtn-oceanografia"><span class="material-icons">play_arrow</span></button>
              <button id="pauseBtn-oceanografia" style="display:none;"><span class="material-icons">pause</span></button>
              <button id="nextBtn-oceanografia"><span class="material-icons">skip_next</span></button>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Pestaña 5: Modelos Estacionales -->
    <div id="tab-estacionales" class="tab-panel">
      <div id="layout-estacional">
        
        <!-- Mapa principal -->
        <div id="map-estacional"></div>

        <!-- Leyenda (se muestra según variable) -->
        <div id="legend-wrapper-estacional" style="display:none;">
          <img id="legend-img-estacional" src="" alt="Leyenda estacional">
        </div>

        <!-- Controles a la derecha -->
        <div id="variable-selector-estacional">
          <span class="section-label">Configuración del Modelo</span>
          <div class="select-wrapper">
            <div class="select-header">
              <span>Modelo Estacional</span>
              <span class="material-icons">timeline</span>
            </div>
            <select id="modelo-estacional">
            <option value="ENSAMBLE" selected>ENSAMBLE</option>
          </select>
          </div>

          <span class="section-label">Área de Enfoque</span>
          <div class="select-wrapper">
            <div class="select-header">
              <span>Selecciona el estado</span>
              <span class="material-icons">public</span>
            </div>
            <select id="buscador-estacional">
            <option value="">-- Selecciona un estado --</option>
            <option value="republica_mexicana">República Mexicana</option>
            <option value="aguascalientes">Aguascalientes</option>
            <option value="baja_california">Baja California</option>
            <option value="baja_california_sur">Baja California Sur</option>
            <option value="campeche">Campeche</option>
            <option value="chiapas">Chiapas</option>
            <option value="chihuahua">Chihuahua</option>
            <option value="ciudad_de_mexico">Ciudad de México</option>
            <option value="coahuila">Coahuila</option>
            <option value="colima">Colima</option>
            <option value="durango">Durango</option>
            <option value="estado_de_mexico">Estado de México</option>
            <option value="guanajuato">Guanajuato</option>
            <option value="guerrero">Guerrero</option>
            <option value="hidalgo">Hidalgo</option>
            <option value="jalisco">Jalisco</option>
            <option value="michoacan">Michoacán</option>
            <option value="morelos">Morelos</option>
            <option value="nayarit">Nayarit</option>
            <option value="nuevo_leon">Nuevo León</option>
            <option value="oaxaca">Oaxaca</option>
            <option value="puebla">Puebla</option>
            <option value="queretaro">Querétaro</option>
            <option value="quintana_roo">Quintana Roo</option>
            <option value="san_luis_potosi">San Luis Potosí</option>
            <option value="sinaloa">Sinaloa</option>
            <option value="sonora">Sonora</option>
            <option value="tabasco">Tabasco</option>
            <option value="tamaulipas">Tamaulipas</option>
            <option value="tlaxcala">Tlaxcala</option>
            <option value="veracruz">Veracruz</option>
            <option value="yucatan">Yucatán</option>
            <option value="zacatecas">Zacatecas</option>
          </select>
          </div>

          <div class="select-wrapper">
            <div class="select-header">
              <span>Variable Climática</span>
              <span class="material-icons">thermostat</span>
            </div>
            <select id="variable-estacional">
            <option value="ANOM_TMAX">Anomalía Temp. Máxima</option>
            <option value="ANOM_TMIN">Anomalía Temp. Mínima</option>
            <option value="ANOM_LLUVIA">Anomalía Precipitación</option>
          </select>
          </div>

          <div class="select-wrapper">
            <div class="select-header">
              <span>Período</span>
              <span class="material-icons">calendar_month</span>
            </div>
            <select id="mes-estacional"></select>
          </div>
        </div>

        <!-- Espacio para slider (no se usa en estacionales) -->
        <div id="bottom-controls-estacional"></div>

      </div>
    </div>

  </div>
</div>


<footer>
  © 2026 · Desarrollado por M.C. José Antonio Guzzi Ferez · Visualización meteorológica
</footer>

</body>

</html>
